# 有痕埋点

## 客户端埋点
「打开商品详情页」、「加入购物车」、「提交订单」这 3 个事件均为客户端的用户行为，适合客户端埋点。
因为：
客户端可采集的å字段更丰富；
有利于关联用户设备标识与用户行为。

## 服务端埋点

对于「支付成功」这个业务结果事件，一般建议使用服务端埋点：
因为：
有利于排除客户端网络环境不稳定造成的数据误差。
如果客户端界面上有多个支付入口，使用服务端埋点可以确保各入口数据完整上报，而客户端埋点容易漏埋。

上述场景将客户端埋点与服务端埋点两种埋点方式相结合，互补各自的优劣势，达到数据的完整、准确、高效上报。

### 适用业务场景

1. 发生的入口比较多
2. 业务状态在客户端没有体现

## 比较

![](_pic/Event-Tracking-Compare.png)

客户端埋点需要多个客户端（Android、iOS、PC）开发团队的埋点资源，而使用服务端埋点，则可以节省多个开发团队的沟通成本。

## 埋点方式

客户端埋点适用于用户界面行为的上报，服务端埋点适用于业务操作的上报。
以经典的「电商购买」业务流程为例：
打开详情页-》加入购物车-》提交订单-》支付成功

## 埋点设计

### 确认事件与变量

事件：指产品中的操作
变量：指描述事件的属性

可以按照产品流程（用户旅程）来设计关键事件，如果想要进一步描述事件属性，那么就可以将属性作为事件的变量。

以汉光百货「站内转化路径追踪」这一电商行业的核心场景为例：
其需要追踪的关键指标，是四个产品操作步骤：浏览商品详情页、加入购物车、结算、支付成功。

这四个指标分别代表四个事件。
如果想要进一步监控不同品牌、不同商品的购买转化率，就需要用品牌和商品的维度去拆解关键指标，那么品牌和商品就是这四个事件的变量。

### 明确事件的触发时机

事件的触发时机，往往是影响数据准确性的重要因素。
以「加入购物车」事件为例，触发时机是点击这个按钮时，还是加入购物车成功时呢？

不同的触发时机代表不同的数据统计口径，我们要尽量选择最贴近业务的统计口径，然后再与开发沟通，在可行性与业务贴合度之间找到最优解。

另外，由于产品中可能有多个入口均可“加入购物车”，触发入口是否已列举完整，也会影响数据准确性。
这个时候，我们可以采用 MECE 原则，即相互独立，完全穷尽：不要重复列举，但要包含所有入口。

### 规范命名

对事件进行规范统一的命名，有助于提高数据的实用性及数据管理效率。
建议使用「动词+名词」或者「名词+动词」的规则来命名，比如“加入购物车”事件，就可以命名为：addToCart。

无论如何，需要确保的是，团队/公司内部必须建立统一的认知，使用同一套命名规则。

### 明确优先级

考虑到埋点的技术实现成本以及资源有限性，在设计埋点方案时，一定要对埋点事件有明确的优先级排布。
在汉光百货这个案例中，优先级最高的场景是“站内转化路径追踪”。
我们以这个场景为轴心，了解每个转化步骤的情况，找到优化点对症下药，再对优化点进一步的监控与验证分析，最终实现价值的持续交付。

![](_pic/EventTracking-Sample.png)

## 埋点协作流程

![](_pic/EventTracking-Workflow.jpg)

事实上，如果产品经理等业务人员总是能用上准确的、及时的数据，并能深度分析，
那么这家公司的组织能力、数据治理的能力，以及数据驱动的文化往往都很优秀。

## 埋点的劣势

最终可能导致诸如：
没有埋上点，埋点数据异常，埋点上线业务已经下线，想分析的维度忘了「埋」上去等等。
